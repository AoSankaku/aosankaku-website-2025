<script is:inline>
  /**
   * This script removes Gatsby's service worker and clears local caches.
   * It prevents returning visitors from seeing a cached version of the old site.
   */
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.getRegistrations().then(function (registrations) {
      for (let registration of registrations) {
        registration.unregister();
        console.log("Old Service Worker unregistered");
      }
      // Optional: Force a one-time reload to ensure the new site is clean
      if (registrations.length > 0) {
        window.location.reload();
      }
    });
  }

  // Clear old Gatsby Caches
  if ("caches" in window) {
    caches.keys().then(function (names) {
      for (let name of names) {
        caches.delete(name);
      }
    });
  }
</script>
