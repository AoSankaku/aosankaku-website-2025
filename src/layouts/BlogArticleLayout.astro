---
import Layout from "./Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import { Image } from "astro:assets";
import ogDefaultImage from "@/assets/og-default.png";

const { frontmatter } = Astro.props;
const { slug } = Astro.params;
const { thumbnail } = frontmatter;

const images = import.meta.glob<{ default: ImageMetadata }>(
  `../content/blog/**/*.{jpeg,jpg,png,gif}`,
  { eager: true },
);
const articleImage =
  images[
    `../content/blog/${slug}/${thumbnail ? thumbnail.replace(/^\.\//, "") : null}`
  ]?.default ?? ogDefaultImage;
---

<Layout>
  <Header />
  <div class="blog-hero">
    <Image src={articleImage} alt={frontmatter.alt} />
    <h1>{frontmatter.title}</h1>
  </div>
  <div class="container">
    <slot />
  </div>
  <Footer />
</Layout>

<style>
  h1 {
    text-align: center;
    padding: 0 50px;
  }

  .container {
    max-width: 768px;
    padding: 0 30px 80px;
    margin: 0 auto;
    p {
      max-width: 100vw;
    }
    img {
      max-width: 100%;
      object-fit: contain;
      height: auto;
    }
  }

  .blog-hero {
    max-width: 100%;

    img {
      max-width: 100%;
      object-fit: cover;
      aspect-ratio: 1280 / 720;
      height: auto;
    }
  }
</style>
